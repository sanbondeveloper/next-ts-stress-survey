# Stress-Survey

## 프로젝트 소개

스트레스 자가진단 설문지

### 요구사항

- Node.js 18.17
- NPM 9.6.7

## 구현 방법 및 고민했던 점

### 사용자 정보 입력 및 저장

팀과 이름의 입력에 대해 비제어 컴포넌트, 제어 컴포넌트, 네이티브 폼 기능 중 어느 방식을 사용할지 고민했고 팀과 이름이 모두 입력되었을 때만 버튼을 활성화하기 위해 제어 컴포넌트 방식을 선택했습니다.

사용자 정보를 저장하기 위해 Context와 Recoil 중 어떤 기술 스택을 사용할지 고민했습니다. Context를 사용하면 렌더링 성능을 고려해 상태와 업데이트 함수에 대해 컨텍스트를 분리해야 합니다. 이렇게 하면 하나의 상태 당 최소 2개 이상의 Context가 생기게 되고 이는 코드가 복잡해질 수 있습니다. 따라서 내부적으로 렌더링 성능 최적화를 지원하고 리액트의 상태관리 방식과 비슷한 Recoil을 사용했습니다.

또한, 재사용성을 높이고 변경 사항이 생겼을 때 일부분만 수정할 수 있도록 팀과 이름을 입력받는 인풋을 공통 컴포넌트 `<Input />`으로 구현했습니다.

### 질문 데이터 패칭

질문 데이터를 상수로 정의할지 JSON 파일로 정의할지 고민했습니다. 상수는 애플리케이션 내부에서 정의하는 것이고 JSON 파일은 애플리케이션 외부에서 정의하는 것이라고 생각했습니다. 질문 데이터는 애플리케이션 외부에서 가져오는 것이 맞다고 판단해 JSON 파일로 정의했습니다.

서버 컴포넌트에서 데이터 패칭을 하면 시간 단축 등의 이점이 있어 서버 컴포넌트에서 fetch API를 통해 질문 데이터를 가져왔습니다. 데이터 패칭을 실패했을 때를 고려하여 Next.js의 특수파일인 error.tsx를 통해 fallback UI를 구현했습니다.

### `<MultiStepForm />` 구현

`<MultiStepForm />`은 form 아이템들을 하나씩 보여주며 이전 문제, 다음 문제로 전환해주는 역할을 합니다.

과제 첫째 날 가장 많은 고민을 한 부분입니다. 첫 번째 고민은 질문의 유형에 따라 렌더링할 컴포넌트를 컴포넌트 내부가 아니라 외부에서 정의해주고 싶었습니다. 이렇게 생각한 이유는 질문의 유형에 따라 렌더링되는 컴포넌트는 언제든 변경될 수 있다고 생각했습니다. 그래서 로직과 렌더링할 JSX를 분리하고 싶었고 Render Props 패턴이 생각났습니다. Render Props 패턴을 활용해 구현했고 비교적 좋은 선택을 좋은 선택을 했던거 같습니다.

최종 결과물을 보면 `<MultiStepForm />`은 질문을 전환하는 기능만 담당하며 렌더링할 JSX, key 지정, Validation은 모두 외부에서 정의합니다.

### 주관식

- 0으로만 이루어진 값 입력시
- 10을 초과하는 값 입력시
- 복사, 붙여넣기 고려

```tsx
<MultiStepForm
  items={questions}
  keyFn={(item) => item.id.toString()}
  validationFn={(item, value) => {
    if (item.type === 'RADIO' && (!value || value?.length === 0)) return false;
    if (item.type === 'INPUT' && (!value || value?.length === 0)) return false;

    return true;
  }}
>
  {(item) => <RadioGroup question={item} />}
</MultiStepForm>
```

두 번째 아이템을 렌더링할 때 현재 스텝에 대한 컴포넌트만 렌더링할지 전체 스텝을 다 렌더링하고 CSS로 현재 스텝만 보여줄지에 대한 고민이었습니다. 전자의 방식이 컴포넌트 제거 및 생성을 반복적으로 한다는 점에서 성능적으로 좋지 않다고 느꼈고 후자의 방식을 선택했습니다. CSS를 활용해 하나의 문제가 폼 전체를 채우게 하고 `transform` 속성으로 x축을 이동시켰습니다.

```tsx
const [step, setStep] = useState(0);

const containerStyle = {
  transform: `translateX(-${step * 100}%)`,
};
```

### 사용자가 선택한 보기 저장

부모 컴포넌트와 `children prop`으로 렌더링된 자식 컴포넌트간 데이터를 공유할 때 주로 Context를 사용하는 것으로 알고 있습니다. 현재 프로젝트는 Recoil을 사용하기로 결정해서 Recoil로 사용자가 선택한 보기를 저장했습니다.

## 할 일

### 기본 요구사항

- [x] 문제 만들기
  - [x] 주제 정하기
  - [x] 5지선다 문제 (1~5점으로 환산할 수 있어야 함)
  - [x] 주관식 문제 (1~10 점수 입력)
  - [x] 5지선다 다중 선택 (문제의 답은 선택한 값의 합)
- [ ] 멀티 스텝 폼 구현
  - [x] 질문 데이터를 가져온다.
  - [x] 다음, 이전 버튼을 구현한다.
  - [ ] Application storage에 사용자와 점수를 저장한다.
- [x] 사용자 정보 입력 페이지 구현
  - [x] 팀과 이름을 입력받는다.
  - [x] 사용자 정보를 저장한다.
- [x] 5지선다 문제 컴포넌트 구현
  - [x] 보기 중 하나만 선택할 수 있다.
  - [x] 보기 중 하나를 선택해야 다음 문제로 넘어갈 수 있다.
  - [ ] 보기 중복을 고려해 해시값을 붙인다.
- [x] 주관식 문제 컴포넌트 구현
  - [x] 1~10 사이의 숫자만 입력할 수 있다.
  - [x] 복사 & 붙여넣기를 고려한다.
- [ ] 5지선다 다중 선택 컴포넌트 구현
  - [x] 보기 중 여러개 선택할 수 있다.
  - [ ] 선택한 값의 합이 문제의 답이 된다.
  - [ ] 보기 중복을 고려해 해시값을 붙인다.
- [ ] 대시보드 페이지
  - [ ] 사용자가 입력한 데이터를 가져온다.
  - [ ] 팀별 총합, 평균, 표준편차 등 차트 구현

### 추가 요구사항

- [ ] 반응형 디자인 적용
- [ ] 사용자 편의성을 고려한 디자인 개선 혹은 기능 추가
- [ ] 대시보드 페이지 진입 인증 처리
- [ ] 성능 최적화 고민하기

## 커밋 컨벤션

| Type     | 설명                                                                                                  |
| -------- | ----------------------------------------------------------------------------------------------------- |
| Feat     | 새로운 기능 추가                                                                                      |
| Fix      | 버그 수정                                                                                             |
| Refactor | 코드 리팩토링, 파일 혹은 폴더명을 수정하거나 옮기는 작업만인 경우, 파일을 삭제하는 작업만 수행한 경우 |
| Style    | CSS 및 레이아웃 작업수정                                                                              |
| Docs     | 문서 수정                                                                                             |
| Chore    | 설정 관련                                                                                             |
